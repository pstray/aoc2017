* program

  #ip 1
  seti 123 0 5
  bani 5 456 5
  eqri 5 72 5
  addr 5 1 1
  seti 0 0 1
  seti 0 9 5
  bori 5 65536 2
  seti 7571367 9 5
  bani 2 255 4
  addr 5 4 5
  bani 5 16777215 5
  muli 5 65899 5
  bani 5 16777215 5
  gtir 256 2 4
  addr 4 1 1
  addi 1 1 1
  seti 27 1 1
  seti 0 2 4
  addi 4 1 3
  muli 3 256 3
  gtrr 3 2 3
  addr 3 1 1
  addi 1 1 1
  seti 25 6 1
  addi 4 1 4
  seti 17 8 1
  setr 4 6 2
  seti 7 4 1
  eqrr 5 0 4
  addr 4 1 1
  seti 5 5 1


* program

  #ip 1

  |     |    |                   |                      |   | r0 | r1 |    r2 |  r3 |    r4 |           r5 |
  |-----+----+-------------------+----------------------+---+----+----+-------+-----+-------+--------------|
  |     |  0 | seti 123 0 5      | $5 = 123             |   |    |  1 |       |     |       |          123 |
  | l0  |  1 | bani 5 456 5      | $5 = $5 and 456      |   |    |  2 |       |     |       |           72 |
  |     |  2 | eqri 5 72 5       | $5 = $5 == 72        |   |    |  3 |       |     |       |            1 |
  |     |  3 | addr 5 1 1        | jmp +$5              |   |    |  5 |       |     |       |            1 |
  |     |  4 | seti 0 0 1        | jmp 0                | X |    |  1 |       |     |       |            1 |
  |     |  5 | seti 0 9 5        | $5 = 0               |   |    |  6 |       |     |       |            0 |
  | l5  |  6 | bori 5 65536 2    | $2 = $5 or 65536     |   |    |  7 | 65536 |     |       |            0 |
  |     |  7 | seti 7571367 9 5  | $5 = 7571367         |   |    |  8 |       |     |       |      7571367 |
  | l7  |  8 | bani 2 255 4      | $4 = $2 and 255      |   |    |  9 |       |     |     0 |              |
  |     |  9 | addr 5 4 5        | $5 = $5 + $4         |   |    | 10 |       |     |       |      7571367 |
  |     | 10 | bani 5 16777215 5 | $5 = $5 and 16777215 |   |    | 11 |       |     |       |      7571367 |
  |     | 11 | muli 5 65899 5    | $5 = $5 * 65899      |   |    | 12 |       |     |       | 498945513933 |
  |     | 12 | bani 5 16777215 5 | $5 = $5 and 16777215 |   |    | 13 |       |     |       |      7887309 |
  |     | 13 | gtir 256 2 4      | $4 = 256 > $2        |   |    | 14 |       |     |     0 |              |
  |     | 14 | addr 4 1 1        | jmp +$4              |   |    | 15 |       |     |       |              |
  |     | 15 | addi 1 1 1        | jmp +1               |   |    | 17 |       |     |       |              |
  |     | 16 | seti 27 1 1       | jmp 27               | X |    | 28 |       |     |       |              |
  |     | 17 | seti 0 2 4        | $4 = 0               |   |    | 18 |       |     |     0 |              |
  | l17 | 18 | addi 4 1 3        | $3 = $4+1            |   |    | 19 |       |   1 |       |              |
  |     | 19 | muli 3 256 3      | $3 = $3 * 256        |   |    | 20 |       | 256 |       |              |
  |     | 20 | gtrr 3 2 3        | $3 = $3 > $2         |   |    | 21 |       |   0 |       |              |
  |     | 21 | addr 3 1 1        | jmp +$3              |   |    | 22 |       |     |       |              |
  |     | 22 | addi 1 1 1        | jmp +1               |   |    | 24 |       |     |       |              |
  |     | 23 | seti 25 6 1       | jmp 25               | X |    | 26 |       |     |       |              |
  |     | 24 | addi 4 1 4        | $4++                 |   |    | 25 |       |     |     1 |              |
  |     | 25 | seti 17 8 1       | jmp 17               |   |    | 18 |       |     |       |              |
  |     | 26 | setr 4 6 2        | $2 = $4              |   |    | 27 |   256 |     | (256) |              |
  |     | 27 | seti 7 4 1        | jmp 7                |   |    |  8 |       |     |       |              |
  | l27 | 28 | eqrr 5 0 4        | $4 = $5 == $0        |   | ?  | 29 |       |     |       |              |
  |     | 29 | addr 4 1 1        | jmp +$4              |   |    | 31 |       |     |       |              |
  |     | 30 | seti 5 5 1        | jmp 5                |   |    |  6 |       |     |       |              |
  |     | 31 | EXIT              |                      |   |    |    |       |     |       |              |

* the core program

  |     |    |                   |                      |   |                                             |    r2 |           r5 |
  |-----+----+-------------------+----------------------+---+---------------------------------------------+-------+--------------|
  |     |    |                   |                      |   | while (123 & 456 != 72) {                   |       |              |
  |     |  0 | seti 123 0 5      | $5 = 123             |   |                                             |       |          123 |
  | l0  |  1 | bani 5 456 5      | $5 = $5 and 456      |   |                                             |       |           72 |
  |     |  2 | eqri 5 72 5       | $5 = $5 == 72        |   |                                             |       |            1 |
  |     |  3 | addr 5 1 1        | jmp +$5              |   |                                             |       |            1 |
  |     |  4 | seti 0 0 1        | jmp 0                |   | }                                           |       |            1 |
  |     |    |                   |                      |   |                                             |       |              |
  |     |  5 | seti 0 9 5        | $5 = 0               | X | $5 = 0                                      |       |            0 |
  |     |    |                   |                      | X | while ($5 != $0) {                          |       |              |
  | G6  |  6 | bori 5 65536 2    | $2 = $5 or 65536     |   | $2 = $5 or 65536                            | 65536 |            0 |
  |     |  7 | seti 7571367 9 5  | $5 = 7571367         |   | $5 = 7571367                                |       |      7571367 |
  |     |    |                   |                      |   | for(;;) {                                   |       |              |
  | l7  |  8 | bani 2 255 4      | $4 = $2 and 255      |   | $4 = $2 and 0xFF                            |       |              |
  |     |  9 | addr 5 4 5        | $5 = $5 + $4         |   | $5 = $5 + $4                                |       |      7571367 |
  |     | 10 | bani 5 16777215 5 | $5 = $5 and 16777215 |   | $5 = $5 and 0xFFFFFF                        |       |      7571367 |
  |     | 11 | muli 5 65899 5    | $5 = $5 * 65899      |   | $5 = $5 * 65899                             |       | 498945513933 |
  |     | 12 | bani 5 16777215 5 | $5 = $5 and 16777215 |   | $5 = $5 and 0xFFFFFF                        |       |      7887309 |
  |     | 13 | gtir 256 2 4      | $4 = 256 > $2        |   | if (256 > $2)                               |       |              |
  |     | 14 | addr 4 1 1        | jmp +$4              |   |                                             |       |              |
  |     | 15 | addi 1 1 1        | jmp +1               |   |                                             |       |              |
  |     | 16 | seti 27 1 1       | jmp 27               |   | goto 28                                     |       |              |
  |     |    |                   |                      |   |                                             |       |              |
  |     | 17 | seti 0 2 4        | $4 = 0               | X |                                             |       |              |
  |     |    |                   |                      | X | // for ($4 = 0; (($4+1)*256 <= $2); $4++) { |       |              |
  | l17 | 18 | addi 4 1 3        | $3 = $4+1            | X | // effektivt $4 = $2/256                    |       |              |
  |     | 19 | muli 3 256 3      | $3 = $3 * 256        | X |                                             |       |              |
  |     | 20 | gtrr 3 2 3        | $3 = $3 > $2         | X |                                             |       |              |
  |     | 21 | addr 3 1 1        | jmp +$3              | X |                                             |       |              |
  |     | 22 | addi 1 1 1        | jmp +1               | X |                                             |       |              |
  |     | 23 | seti 25 6 1       | jmp 25               | X |                                             |       |              |
  |     |    |                   |                      | X |                                             |       |              |
  |     | 24 | addi 4 1 4        | $4++                 | X |                                             |       |              |
  |     | 25 | seti 17 8 1       | jmp 17               | X | // }                                        |       |              |
  |     | 26 | setr 4 6 2        | $2 = $4              |   | // $2 = $4                                  |       |              |
  |     |    |                   |                      |   | $2 = $2 >> 8                                |       |              |
  |     | 27 | seti 7 4 1        | jmp 7                |   | goto 8                                      |       |              |
  |     |    |                   |                      |   | }                                           |       |              |
  |     |    |                   |                      |   |                                             |       |              |
  | l27 | 28 | eqrr 5 0 4        | $4 = $5 == $0        |   |                                             |       |              |
  |     | 29 | addr 4 1 1        | jmp +$4              |   |                                             |       |              |
  |     | 30 | seti 5 5 1        | jmp 5                |   |                                             |       |              |
  |     |    |                   |                      | X | }                                           |       |              |

* Translated to C-like

  #+BEGIN_SRC C
    var5 = 0;
    while (var5 != var0) {
      var2 = var5 | 0x10000;
      var5 = 7571367; /* 7387A7 */
      for(; var2 >= 256; var2 >>= 8) {
	var4 = var2 & 0xFF;
	var5 = var5 + var4;
	var5 = var5 & 0xFFFFFF;
	var5 = var5 * 65899; /* 0x1016B */
	var5 = var5 & 0xFFFFFF;
      }
     }
  #+END_SRC
